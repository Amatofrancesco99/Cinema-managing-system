@import cinema.model.cinema.Cinema
@import cinema.model.Projection
@import cinema.test.Film
@import java.time.format.DateTimeFormatter
@import java.time.format.TextStyle

@args() {
    Cinema cinema
    Film film
    List<List<Projection>> schedule
}

@extends(wireframe, cinema=cinema, pageTitle="Dettagli film")

@section(content) {
    <div class="container pt-5">
        <div class="row pt-5 mb-2 pb-4">
            <div class="col-md-12">
                <div class="row p-4 g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                    <div class="col-auto d-block text-center mx-auto mx-lg-2">
                        <img src="@(film.getImageURL())" class="img-fluid rounded">
                    </div>
                    <div class="col p-4 d-flex flex-column position-static">
                        <div class="text-end">
                            <a class="text-muted pt-4" href="@(film.getTrailerURL())" target="_blank" rel="noopener noreferrer">
                                Vai al trailer
                            </a>
                        </div>
                        <h3 class="mb-0">
                            @(film.getTitle())
                        </h3>
                        <p class="card-text mt-3">
                            @(film.getDescription())
                        </p>
                        <table class="table table-borderless">
                            <tbody>
                                <tr>
                                    <td class="text-muted">
                                        Genere
                                    </td>
                                    <td>
                                        @(film.getGenres().join(", "))
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-muted">
                                        Regia
                                    </td>
                                    <td>
                                        @(film.getDirectors().join(", "))
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-muted">
                                        Cast
                                    </td>
                                    <td>
                                        @(film.getCast().join(", "))
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-muted">
                                        Rating
                                    </td>
                                    <td>
                                        <div class="mb-1 text-muted">
                                            @for (int i = 0; i < film.getRating(); i++) {
                                                <span class="fa fa-star" style="color: orange;"></span>
                                            }
                                            @for (int i = 0; i < (5 - film.getRating()); i++) {
                                                <span class="fa fa-star"></span>
                                            }
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-muted">
                                        Durata
                                    </td>
                                    <td>
                                        @(film.getDuration())
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div id="buy-now" class="card mb-auto">
                            <p class="card-header text-center bg-dark bg-gradient text-warning">
                                <strong>
                                    ACQUISTA ORA
                                </strong>
                            </p>
                            <div class="card-body">
                                @for(ArrayList<Projection> dailyProjections : schedule) {
                                    <div>
                                        @(dailyProjections.get(0).getDateTime().getDayOfWeek().getDisplayName(TextStyle.FULL, Locale.ITALIAN).capitalizeWords().escape("html"))
                                        <strong>
                                            @(dailyProjections.get(0).getDateTime().getDayOfMonth().format("00"))/@(dailyProjections.get(0).getDateTime().getMonthValue().format("00"))
                                        </strong>
                                    </div>
                                    <div>
                                        @for(Projection projection : dailyProjections) {
                                            <a class="btn btn-sm btn-primary mt-2 mb-3" href="/checkout?id=@(projection.getId())#" role="button">
                                                @(projection.getDateTime().getHour().format("00")):@(projection.getDateTime().getMinute().format("00"))
                                            </a>
                                        }
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
